# 策略管理功能设计

## 📋 功能概述

**模块名称**: 策略管理中心  
**核心目标**: 提供完整的量化策略生命周期管理  
**主要用户**: 量化投资者、策略开发者、系统管理员  

## 🎯 核心功能模块

### 1. 📊 策略概览面板

#### 策略卡片展示
- **策略基本信息**
  - 策略名称和版本
  - 策略类型标识
  - 运行状态指示器
  - 创建时间和最后更新时间

- **关键性能指标**
  - 累计收益率
  - 胜率统计
  - 最大回撤
  - 夏普比率
  - 年化收益率

- **快速操作按钮**
  - 启动/停止策略
  - 编辑策略参数
  - 查看详细信息
  - 复制策略配置
  - 删除策略

#### 界面布局
```
┌─────────────────────────────────────────────────────────┐
│ 策略管理中心 | [新建策略] [导入策略] [批量操作]          │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│ │ 动量策略    │ │ ML策略      │ │ 自定义策略  │        │
│ │ ●运行中     │ │ ○已停止     │ │ ●运行中     │        │
│ │ 收益:+5.2%  │ │ 收益:+3.1%  │ │ 收益:+7.8%  │        │
│ │ 胜率:65.2%  │ │ 胜率:58.7%  │ │ 胜率:72.3%  │        │
│ │ 回撤:-2.1%  │ │ 回撤:-3.5%  │ │ 回撤:-1.8%  │        │
│ │[编辑][停止] │ │[编辑][启动] │ │[编辑][停止] │        │
│ └─────────────┘ └─────────────┘ └─────────────┘        │
└─────────────────────────────────────────────────────────┘
```

### 2. ⚙️ 策略详细配置

#### 参数设置面板
- **基础参数**
  - 策略名称和描述
  - 策略类型选择
  - 运行模式设置
  - 数据源配置

- **交易参数**
  - 买入/卖出阈值
  - 持仓数量限制
  - 单股最大仓位
  - 最小交易金额
  - 交易频率控制

- **技术指标参数**
  - 移动平均周期
  - 动量计算周期
  - RSI参数设置
  - MACD参数配置
  - 自定义指标参数

#### 参数配置界面
```
┌─────────────────────────────────────────────────────────┐
│ 动量策略详细配置                              [关闭]    │
├─────────────────────────────────────────────────────────┤
│ [参数设置] [风险控制] [执行日志] [性能分析]            │
├─────────────────────────────────────────────────────────┤
│ 动量周期(天):     [20    ] 买入阈值(%):   [5.0   ]    │
│ 卖出阈值(%):      [-3.0  ] 最大持仓数:   [10    ]    │
│ 单股最大仓位(%):  [10.0  ] 最小交易金额: [10000 ]    │
│                                                         │
│ [保存参数] [重置] [参数测试]                           │
└─────────────────────────────────────────────────────────┘
```

### 3. 🛡️ 风险控制设置

#### 风险管理参数
- **止损止盈设置**
  - 固定止损比例
  - 动态止损策略
  - 止盈目标设置
  - 分批止盈配置

- **仓位控制**
  - 总仓位限制
  - 单股仓位限制
  - 行业集中度控制
  - 相关性风险控制

- **风险监控**
  - 最大回撤限制
  - VaR风险值设置
  - 波动率监控
  - 流动性风险控制

### 4. 📈 性能分析模块

#### 实时性能监控
- **收益率分析**
  - 累计收益率曲线
  - 日收益率分布
  - 月度收益统计
  - 年化收益率计算

- **风险指标**
  - 最大回撤分析
  - 夏普比率计算
  - 索提诺比率
  - 卡尔马比率

- **交易统计**
  - 交易次数统计
  - 胜率和败率
  - 平均持仓时间
  - 换手率分析

#### 性能对比分析
- **策略间对比**
  - 多策略收益对比
  - 风险指标对比
  - 相关性分析
  - 组合优化建议

- **基准对比**
  - 与市场指数对比
  - 与同类策略对比
  - 超额收益分析
  - 信息比率计算

### 5. 📝 执行日志系统

#### 日志记录功能
- **交易日志**
  - 买卖信号记录
  - 订单执行详情
  - 成交价格和数量
  - 手续费和滑点

- **系统日志**
  - 策略启停记录
  - 参数修改历史
  - 错误和异常记录
  - 性能监控日志

- **决策日志**
  - 信号生成原因
  - 风控触发记录
  - 参数调整依据
  - 策略优化记录

#### 日志查看界面
```
┌─────────────────────────────────────────────────────────┐
│ 执行日志                                               │
├─────────────────────────────────────────────────────────┤
│ 时间     | 级别 | 消息内容                              │
├─────────────────────────────────────────────────────────┤
│ 14:32:15 | INFO | 策略启动成功，开始监控市场数据        │
│ 14:30:42 | SUCC | 买入信号: 000001 平安银行，价格: 13.15│
│ 14:28:33 | WARN | 000002 万科A 价格波动异常，暂停交易   │
│ 14:25:18 | ERRO | 数据源连接失败，尝试重新连接          │
└─────────────────────────────────────────────────────────┘
```

## 🔧 技术实现方案

### 数据模型设计

#### 策略配置表
```sql
CREATE TABLE strategies (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL,
    version VARCHAR(20) DEFAULT '1.0',
    status VARCHAR(20) DEFAULT 'stopped',
    config JSONB NOT NULL,
    risk_config JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

#### 策略性能表
```sql
CREATE TABLE strategy_performance (
    id SERIAL PRIMARY KEY,
    strategy_id INTEGER REFERENCES strategies(id),
    date DATE NOT NULL,
    total_return DECIMAL(10,4),
    daily_return DECIMAL(10,4),
    max_drawdown DECIMAL(10,4),
    sharpe_ratio DECIMAL(10,4),
    win_rate DECIMAL(5,2),
    trade_count INTEGER,
    updated_at TIMESTAMP DEFAULT NOW()
);
```

### API接口设计

#### 策略管理接口
```python
# 获取策略列表
GET /api/strategies
Response: {
    "strategies": [
        {
            "id": 1,
            "name": "动量策略",
            "type": "momentum",
            "status": "running",
            "performance": {
                "total_return": 5.23,
                "win_rate": 65.2,
                "max_drawdown": -2.1
            }
        }
    ]
}

# 创建新策略
POST /api/strategies
Request: {
    "name": "新策略",
    "type": "custom",
    "config": {...}
}

# 更新策略配置
PUT /api/strategies/{id}
Request: {
    "config": {...},
    "risk_config": {...}
}

# 启动/停止策略
POST /api/strategies/{id}/control
Request: {
    "action": "start" | "stop" | "pause"
}
```

### 前端组件设计

#### 策略卡片组件
```javascript
const StrategyCard = ({ strategy, onEdit, onToggle, onView }) => {
    return (
        <div className={`strategy-card ${strategy.status === 'running' ? 'active' : ''}`}>
            <div className="strategy-header">
                <h3>{strategy.name} v{strategy.version}</h3>
                <StatusIndicator status={strategy.status} />
            </div>
            <div className="strategy-metrics">
                <Metric label="收益率" value={`${strategy.performance.total_return}%`} />
                <Metric label="胜率" value={`${strategy.performance.win_rate}%`} />
                <Metric label="最大回撤" value={`${strategy.performance.max_drawdown}%`} />
            </div>
            <div className="strategy-actions">
                <Button onClick={() => onEdit(strategy.id)}>编辑</Button>
                <Button onClick={() => onToggle(strategy.id)}>
                    {strategy.status === 'running' ? '停止' : '启动'}
                </Button>
                <Button onClick={() => onView(strategy.id)}>详情</Button>
            </div>
        </div>
    );
};
```

## 🚀 开发优先级

### 第一阶段 (1周) - 基础功能
- [ ] 策略列表展示
- [ ] 基础策略配置
- [ ] 策略启停控制
- [ ] 简单性能指标

### 第二阶段 (1周) - 高级配置
- [ ] 详细参数配置
- [ ] 风险控制设置
- [ ] 参数验证和测试
- [ ] 配置导入导出

### 第三阶段 (1周) - 监控分析
- [ ] 执行日志系统
- [ ] 性能分析图表
- [ ] 策略对比功能
- [ ] 实时监控面板

## 💡 用户体验设计

### 交互流程
1. **策略概览** → 用户进入策略管理页面，查看所有策略状态
2. **选择策略** → 点击策略卡片，查看详细信息
3. **配置参数** → 在详情面板中调整策略参数
4. **启动策略** → 保存配置并启动策略运行
5. **监控性能** → 实时查看策略执行情况和性能指标

### 操作便捷性
- **一键操作** - 策略启停、参数重置等常用操作
- **批量管理** - 支持多策略同时操作
- **快速切换** - 策略间快速切换和对比
- **实时反馈** - 操作结果即时通知

### 视觉设计
- **状态指示** - 清晰的运行状态标识
- **性能可视化** - 图表化的性能指标展示
- **响应式布局** - 适配不同屏幕尺寸
- **主题一致性** - 与整体系统风格统一

---

这个策略管理功能设计为用户提供了完整的策略生命周期管理能力，从创建、配置、运行到监控分析，形成了一个闭环的管理体系。
